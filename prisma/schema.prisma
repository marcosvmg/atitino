generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String        @id @default(cuid())
  username     String        @unique
  password     String
  name         String?
  avatarUrl    String?
  bio          String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  interactions Interaction[]
}

model Movie {
  id           String        @id @default(cuid())
  tmdbId       Int
  type         String
  title        String
  overview     String?
  posterPath   String?
  backdropPath String?
  releaseDate  String?

  interactions Interaction[]

  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  @@unique([tmdbId, type])
}

model Interaction {
  id             String   @id @default(cuid())

  rating         Int?     // Nota 0-5
  review         String?

  // Novos Campos
  status         String   @default("WATCHED") // "WATCHED", "WATCHING", "PLAN"
  watchedSeasons Int[]    // Lista de temporadas: ex [1, 2]

  // Campo legado (podemos manter ou ignorar, o status substitui ele)
  watched        Boolean  @default(true)

  userId         String
  user           User     @relation(fields: [userId], references: [id])

  movieId        String
  movie          Movie    @relation(fields: [movieId], references: [id])

  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@unique([userId, movieId])
}